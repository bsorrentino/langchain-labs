{
    "cells": [
        {
            "language": "markdown",
            "source": [
                "Initialize [OpenAI nodejs SDK](https://www.npmjs.com/package/openai)"
            ],
            "outputs": []
        },
        {
            "language": "typescript",
            "source": [
                "import { Configuration, OpenAIApi } from \"openai\";\n\n\nconst configuration = new Configuration({\n  apiKey: process.env.OPENAI_API_KEY,\n});\n\nconst openai = new OpenAIApi(configuration);\n"
            ],
            "outputs": [
                {
                    "items": [
                        {
                            "mime": "application/vnd.code.notebook.error",
                            "value": {
                                "name": "TypeError",
                                "message": "openai_1.Configuration is not a constructor",
                                "stack": "    at <Cell 2> [4, 0]\n    at <Cell 2> [9, 46]\n    at Script.runInContext (node:vm:135:12)\n    at Script.runInNewContext (node:vm:140:17)\n    at Object.runInNewContext (node:vm:292:38)\n    at E (/Users/bsorrentino/.vscode/extensions/donjayamanne.typescript-notebook-3.0.1/out/extension/server/index.js:2:94622)\n    at t.execCode (/Users/bsorrentino/.vscode/extensions/donjayamanne.typescript-notebook-3.0.1/out/extension/server/index.js:2:95460)\n    at O.<anonymous> (/Users/bsorrentino/.vscode/extensions/donjayamanne.typescript-notebook-3.0.1/out/extension/server/index.js:2:102315)\n    at O.emit (node:events:517:28)\n    at O.emit (node:domain:489:12)"
                            }
                        }
                    ]
                }
            ]
        },
        {
            "language": "markdown",
            "source": [
                "install [@azure/openai](https://www.npmjs.com/package/@azure/openai) package and initialize"
            ],
            "outputs": []
        },
        {
            "language": "typescript",
            "source": [
                "import { OpenAIClient, AzureKeyCredential } from \"@azure/openai\";\n"
            ],
            "outputs": []
        },
        {
            "language": "markdown",
            "source": [
                "Let define a `function description` to provide function metadata to GPT"
            ],
            "outputs": []
        },
        {
            "language": "typescript",
            "source": [
                "const function_descriptions = [\n    {\n        \"name\": \"export_solution\",\n        \"description\": \"export a dataverse solution to remove environment\",\n        \"parameters\": {\n            \"type\": \"object\",\n            \"properties\": {\n                \"path\": {\n                    \"type\": \"string\",\n                    \"description\": \"the solution path\",\n                },\n                \"environment\": {\n                    \"type\": \"string\",\n                    \"description\": \"the target environment\",\n                },\n                \"type\": {\n                    \"type\": \"string\",\n                    \"description\": \"the solution type. The default is managed\",\n                    \"enum\": [ \"both\", \"managed\", \"unmanaged\" ]\n                },\n            },\n            \"required\": [\"path\", \"environment\"],\n        },\n    }\n];"
            ],
            "outputs": []
        },
        {
            "language": "typescript",
            "source": [
                "import { OpenAIApi } from \"openai\";\n\ndeclare const openai: OpenAIApi\n\nconst user_query1 = \"let import the solution 'mysolution.zip' from path '/tmp' in environment 'bartolo' as unmanaged\"; \nconst user_query2 = \"how in javascript can iterate over an array\"; \nconst user_query3 = \"how in javascript can iterate over an array and import the solution 'mysolution.zip' from path '/tmp' in environment 'bartolo'\"; \n\ntry {\n  \nconst chatCompletion = await openai.createChatCompletion({\n    model: \"gpt-35-turbo-0613\",\n    messages: [\n      {role: \"user\", content: user_query1}\n    ],\n    functions: function_descriptions,\n    function_call: \"auto\"\n  });\n\n  const { message, finish_reason } = chatCompletion.data.choices[0];\n\n  console.log(finish_reason, message );\n}\ncatch( e ) {\n  console.log( e )\n}"
            ],
            "outputs": []
        },
        {
            "language": "typescript",
            "source": [
                ""
            ],
            "outputs": []
        }
    ]
}